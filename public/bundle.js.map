{"version":3,"file":"bundle.js","sources":["../src/loadMap.js","../src/constants.js","../src/animations.js","../src/update.js","../src/main.js"],"sourcesContent":["const sovietCountryIsoCodes = [\n  \"ARM\",\n  \"AZE\",\n  \"BLR\",\n  \"EST\",\n  \"GEO\",\n  \"KAZ\",\n  \"KGZ\",\n  \"LVA\",\n  \"LTU\",\n  \"MDA\",\n  \"RUS\",\n  \"TJK\",\n  \"TKM\",\n  \"UKR\",\n  \"UZB\"\n];\n\nvar mercatorBounds = function(projection, maxlat) {\n  var yaw = projection.rotate()[0],\n    xymax = projection([-yaw + 180 - 1e-6, -maxlat]),\n    xymin = projection([-yaw - 180 + 1e-6, maxlat]);\n\n  return [xymin, xymax];\n};\n\nexport default function loadMap() {\n  return new Promise((resolve, reject) => {\n    d3.json(\"./json/110topoworld.json\", function(json) {\n      console.warn(\"loaded 110topoworld.json:\", json);\n      const mapContainer = d3.select(\".scroll__graphic\");\n      const boundingBox = mapContainer.node().getBoundingClientRect();\n      const { height, width } = boundingBox;\n\n      var rotate = -20; // so that [-60, 0] becomes initial center of projection\n      var maxlat = 83;\n      var centered;\n      var projection = d3.geo\n        .mercator()\n        .rotate([rotate, 0])\n        .scale(1) // we'll scale up to match viewport shortly.\n        .translate([width / 2, height / 2]);\n      // .center([0, 25])\n      var b = mercatorBounds(projection, maxlat);\n      var s = width / (b[1][0] - b[0][0]);\n      var scaleExtent = [s, 10 * s];\n\n      projection.scale(scaleExtent[0]);\n\n      var path = d3.geo.path().projection(projection);\n\n      const countrySubunits = topojson.feature(json, json.objects.subunits)\n        .features;\n\n      const svg = d3\n        .select(\".scroll__graphic\")\n        .append(\"svg\")\n        .attr(\"width\", width)\n        .attr(\"height\", height);\n\n      const map = svg.append(\"g\").attr(\"id\", \"map\");\n\n      map\n        .selectAll(\"path\")\n        .data(countrySubunits)\n        .enter()\n        .append(\"path\")\n        .attr(\"d\", path)\n        .style(\"stroke-width\", 0.5 + \"px\")\n        .attr(\"class\", \"country\")\n        .attr(\"id\", function(d, i) {\n          return \"country\" + d.id;\n        })\n        .attr(\"class\", function(datapoint, i) {\n          if (sovietCountryIsoCodes.includes(datapoint.id)) {\n            return \"country soviet-country\";\n          } else {\n            return \"country non-soviet-country\";\n          }\n        });\n\n      resolve(countrySubunits);\n    });\n  });\n}\n","export const sovietCountryIsoCodes = [\n  \"ARM\",\n  \"AZE\",\n  \"BLR\",\n  \"EST\",\n  \"GEO\",\n  \"KAZ\",\n  \"KGZ\",\n  \"LVA\",\n  \"LTU\",\n  \"MDA\",\n  \"RUS\",\n  \"TJK\",\n  \"TKM\",\n  \"UKR\",\n  \"UZB\"\n];\n\nexport const colors = [\n  \"#feedde\",\n  \"#fdbe85\",\n  \"#fd8d3c\",\n  \"#e6550d\",\n  \"#a63603\",\n  \"#feedde\",\n  \"#fdbe85\",\n  \"#fd8d3c\",\n  \"#e6550d\",\n  \"#feedde\",\n  \"#fdbe85\",\n  \"#fd8d3c\",\n  \"#e6550d\",\n  \"#a63603\"\n];\n\nexport const sovietLabelShift = {\n  ARM: { x: -12, y: 2 },\n  AZE: { x: -8, y: 5 },\n  BLR: { x: -14, y: 4 },\n  EST: { x: -12, y: 0 },\n  GEO: { x: -13, y: 1 },\n  KAZ: { x: 14, y: 6 },\n  KGZ: { x: 5, y: 3 },\n  LVA: { x: -12, y: 0 },\n  LTU: { x: -14, y: 0 },\n  MDA: { x: -12, y: 1 },\n  RUS: { x: -40, y: 10 },\n  TJK: { x: -4, y: 6 },\n  TKM: { x: -10, y: 8 },\n  UKR: { x: -9, y: 7 },\n  UZB: { x: -12, y: 0 }\n};","import { sovietCountryIsoCodes, colors, sovietLabelShift } from \"./constants\";\n\nfunction firstAnimation() {\n  var scale = 2;\n  const mapContainer = d3.select(\".scroll__graphic\");\n  const boundingBox = mapContainer.node().getBoundingClientRect();\n  const { height, width } = boundingBox;\n\n  var translateX = -Math.floor(width * 0.7);\n  var translateY = -Math.floor(height * 0.4);\n  console.warn(\"firstAnimation translateX\", translateX);\n  console.warn(\"first animation translateY\", translateY);\n\n  console.warn({ scale });\n  console.warn({ width });\n  console.warn({ height });\n\n  console.warn({ translateX });\n  console.warn({ translateY });\n\n  d3.select(\"#map\")\n    .transition()\n    .duration(1000)\n    .attr(\n      \"transform\",\n      \"translate(\" +\n        width / 2 +\n        \",\" +\n        height / 2 +\n        \")scale(\" +\n        scale +\n        \")translate(\" +\n        translateX +\n        \",\" +\n        translateY +\n        \")\"\n    );\n\n  // d3.selectAll(\".soviet-country\")\n  //   .transition()\n  //   .duration(100)\n  //   .style(\"fill\", \"#a63603\")\n  //   .style(\"stroke-width\", 0.5 + \"px\");\n\n  d3.selectAll(\".non-soviet-country\")\n    .transition()\n    .duration(100)\n    .style(\"opacity\", \"0.5\")\n    .style(\"stroke-width\", 0.25 + \"px\");\n\n  d3.selectAll(\".soviet-country\")\n    .transition()\n    .duration(1000)\n    .style(\"fill\", function(d, i) {\n      // console.warn('i', i)\n      return colors[i];\n    });\n}\n\nfunction secondAnimation(countries) {\n  const mapContainer = d3.select(\".scroll__graphic\");\n  const boundingBox = mapContainer.node().getBoundingClientRect();\n  const { width, height } = boundingBox;\n\n  var scale = 4;\n  var translateX = -Math.floor(width * 0.6);\n  var translateY = -Math.floor(height * 0.33);\n\n  d3.select(\"#map\")\n    .transition()\n    .duration(1000)\n    .attr(\n      \"transform\",\n      \"translate(\" +\n        width / 2 +\n        \",\" +\n        height / 2 +\n        \")scale(\" +\n        scale +\n        \")translate(\" +\n        translateX +\n        \",\" +\n        translateY +\n        \")\"\n    );\n\n  d3.selectAll(\".non-soviet-country\")\n    .transition()\n    .duration(500)\n    .style(\"stroke-width\", 0.175 + \"px\");\n\n  d3.selectAll(\".soviet-country\")\n    .transition()\n    .duration(500)\n    .style(\"stroke-width\", 0.25 + \"px\");\n\n  d3.selectAll(\".non-soviet-country\")\n    .transition()\n    .duration(500)\n    .style(\"opacity\", \"0.1\");\n\n  d3.selectAll(\".place-label\")\n    .data(countries)\n    .enter()\n    .append(\"text\")\n    .attr(\"class\", \"place-label\")\n    .attr(\"transform\", function(d) {\n      // can get centroid easily like this!  path.centroid(d)\n      const [x, y] = path.centroid(d);\n      return `translate(${x},${y})`;\n    })\n    .attr(\"dx\", function({ id }) {\n      if (sovietCountryIsoCodes.includes(id)) {\n        const { x } = sovietLabelShift[id];\n        console.warn(x);\n        // can get centroid easily like this!  path.centroid(d)\n        return `${x}px`;\n      }\n      return;\n    })\n    .attr(\"dy\", function(d) {\n      if (sovietCountryIsoCodes.includes(d.id)) {\n        const name = d.id;\n        const { y } = sovietLabelShift[name];\n        // can get centroid easily like this!  path.centroid(d)\n        return `${y}px`;\n      }\n      return;\n    })\n    // .style(\"z-index\", '100')\n    .text(function(d) {\n      if (sovietCountryIsoCodes.includes(d.id)) {\n        console.warn(\"soviet datapoint\", d);\n        return d.properties.name;\n      }\n\n      return;\n    })\n    .style(\"font-size\", 3 + \"px\");\n}\n\nexport default {\n  firstAnimation,\n  secondAnimation\n};\n","import loadMap from \"./loadMap\";\nimport animations from './animations';\n\nexport default function update() {\n  window.onbeforeunload = function() {\n    window.scrollTo(0, 0);\n  };\n\n  // initialize the scrollama\n  var scroller = scrollama();\n\n  // Setup sizes for the graphic and steps\n  var container = d3.select(\".scroll\");\n  var graphic = container.select(\".scroll__graphic\");\n  var text = container.select(\".scroll__text\");\n\n  var bodyWidth = d3.select(\"body\").node().offsetWidth;\n  var textWidth = text.node().offsetWidth;\n\n  var step = text.selectAll(\".step\");\n  var stepHeight = Math.floor(window.innerHeight * 0.75);\n\n  var graphicMargin = 16 * 4; // 64px\n  var graphicWidth = container.node().offsetWidth - graphicMargin;\n  const mapwidth = container.node().offsetWidth;\n  const graphicHeight = graphicWidth;\n  // var graphicHeight = Math.floor(window.innerHeight / 2.4);\n  console.warn({ graphicHeight });\n\n  var graphicMarginTop = Math.floor(window.innerHeight * 0.25);\n  // graphicMargin / 2;\n\n  step.style(\"height\", window.innerHeight + \"px\");\n\n  graphic\n    .style(\"width\", mapwidth + \"px\")\n    .style(\"height\", mapwidth + \"px\")\n    .style(\"top\", graphicMarginTop + \"px\");\n  // -----------------------------------\n  console.warn({ graphicHeight });\n  console.warn({ graphicWidth });\n  console.warn({ stepHeight });\n  console.warn(\"container.node().offsetHeight\", container.node().offsetHeight);\n  d3.select(\".header-container\").style(\"height\", 850 + \"px\");\n\n  d3.select(\".ussr-svg-container\").style(\"width\", graphicWidth + \"px\");\n  d3.select(\".intro-block\").style(\"width\", graphicWidth + \"px\");\n  d3.select(\".name-block\").style(\"width\", graphicWidth + \"px\");\n\n  d3.select(\".ussr-svg\").style(\"height\", 200 + \"px\");\n  d3.select(\".ussr-svg\").style(\"width\", 200 + \"px\");\n  // Animations\n\n  const mapContainer = d3.select(\".scroll__graphic\");\n  const boundingBox = mapContainer.node().getBoundingClientRect();\n  const { height, width } = boundingBox;\n\n  // scrollama event handlers\n  // response = { element, direction, index }\n  function handleStepEnter(response) {\n    console.warn(\"handleStepEnter, response\", { response });\n\n    if (response.index === 0) {\n      console.warn(\"FIRST STEP!\");\n      animations.firstAnimation();\n    }\n\n    if (response.index === 1) {\n      animations.secondAnimation(countries);\n    }\n\n    // add color to current step only\n    step.classed(\"is-active\", function(d, i) {\n      return i === response.index;\n    });\n\n    // update graphic based on step\n    graphic.select(\"p\").text(response.index + 1);\n  }\n\n  function handleContainerEnter(response) {\n    d3.select(\".intro__overline\").classed(\"sticky_break\", true);\n    console.warn({ handleContainerEnter });\n    // response = { direction }\n  }\n\n  function handleContainerExit(response) {\n    console.warn({ handleContainerExit });\n    // response = { direction }\n  }\n\n  function setupStickyfill() {\n    d3.selectAll(\".sticky\").each(function() {\n      Stickyfill.add(this);\n    });\n  }\n\n  function init() {\n    setupStickyfill();\n    scroller\n      .setup({\n        container: \".scroll\",\n        graphic: \".scroll__graphic\",\n        text: \".scroll__text\",\n        step: \".scroll__text .step\",\n        debug: false,\n        offset: 0.9\n      })\n      .onStepEnter(handleStepEnter)\n      .onContainerEnter(handleContainerEnter)\n      .onContainerExit(handleContainerExit);\n\n    // setup resize event -> this is causing issues in mobile when the mobile headers resize\n    // window.addEventListener(\"resize\", handleResize);\n  }\n  // kick things off\n  init();\n\n\tlet countries\n\t\n\tloadMap().then(countrySubunits => {\n\t\tconsole.warn({ countrySubunits });\n\t\tcountries = countrySubunits\n\t\treturn countries\n\t});\n\n}\n","import update from './update.js';\n\n// even though Rollup is bundling all your files together, errors and\n// logs will still point to your original source modules\nconsole.log('if you have sourcemaps enabled in your devtools, click on main.js:5 -->');\n\nupdate();"],"names":["sovietCountryIsoCodes","mercatorBounds","projection","maxlat","yaw","rotate","xymax","xymin","loadMap","Promise","resolve","reject","d3","json","console","warn","mapContainer","select","boundingBox","node","getBoundingClientRect","height","width","geo","mercator","scale","translate","b","s","scaleExtent","path","countrySubunits","topojson","feature","objects","subunits","features","svg","append","attr","map","selectAll","data","enter","style","d","i","id","datapoint","includes","colors","sovietLabelShift","ARM","x","y","AZE","BLR","EST","GEO","KAZ","KGZ","LVA","LTU","MDA","RUS","TJK","TKM","UKR","UZB","firstAnimation","translateX","Math","floor","translateY","transition","duration","secondAnimation","countries","centroid","name","text","properties","update","window","onbeforeunload","scrollTo","scroller","scrollama","container","graphic","bodyWidth","offsetWidth","textWidth","step","stepHeight","innerHeight","graphicMargin","graphicWidth","mapwidth","graphicHeight","graphicMarginTop","offsetHeight","handleStepEnter","response","index","animations","classed","handleContainerEnter","handleContainerExit","setupStickyfill","each","Stickyfill","add","init","setup","debug","offset","onStepEnter","onContainerEnter","onContainerExit","then","log"],"mappings":"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"}