{"version":3,"file":"bundle.js","sources":["../src/loadMap.js","../src/update.js","../src/main.js"],"sourcesContent":["const sovietCountryIsoCodes = [\n  \"ARM\",\n  \"AZE\",\n  \"BLR\",\n  \"EST\",\n  \"GEO\",\n  \"KAZ\",\n  \"KGZ\",\n  \"LVA\",\n  \"LTU\",\n  \"MDA\",\n  \"RUS\",\n  \"TJK\",\n  \"TKM\",\n  \"UKR\",\n  \"UZB\"\n];\n\nvar mercatorBounds = function(projection, maxlat) {\n  var yaw = projection.rotate()[0],\n    xymax = projection([-yaw + 180 - 1e-6, -maxlat]),\n    xymin = projection([-yaw - 180 + 1e-6, maxlat]);\n\n  return [xymin, xymax];\n};\n\nexport default function loadMap() {\n  return new Promise((resolve, reject) => {\n    d3.json(\"./json/110topoworld.json\", function(json) {\n      console.warn(\"loaded 110topoworld.json:\", json);\n      const mapContainer = d3.select(\".scroll__graphic\");\n      const boundingBox = mapContainer.node().getBoundingClientRect();\n      const { height, width } = boundingBox;\n\n      var rotate = -20; // so that [-60, 0] becomes initial center of projection\n      var maxlat = 83;\n      var centered;\n      var projection = d3.geo\n        .mercator()\n        .rotate([rotate, 0])\n        .scale(1) // we'll scale up to match viewport shortly.\n        .translate([width / 2, height / 2]);\n      // .center([0, 25])\n      var b = mercatorBounds(projection, maxlat);\n      var s = width / (b[1][0] - b[0][0]);\n      var scaleExtent = [s, 10 * s];\n\n      projection.scale(scaleExtent[0]);\n\n      var path = d3.geo.path().projection(projection);\n\n      const countrySubunits = topojson.feature(json, json.objects.subunits)\n        .features;\n\n      const svg = d3\n        .select(\".scroll__graphic\")\n        .append(\"svg\")\n        .attr(\"width\", width)\n        .attr(\"height\", height);\n\n      const map = svg.append(\"g\").attr(\"id\", \"map\");\n\n      map\n        .selectAll(\"path\")\n        .data(countrySubunits)\n        .enter()\n        .append(\"path\")\n        .attr(\"d\", path)\n        .style(\"stroke-width\", 0.5 + \"px\")\n        .attr(\"class\", \"country\")\n        .attr(\"id\", function(d, i) {\n          return \"country\" + d.id;\n        })\n        .attr(\"class\", function(datapoint, i) {\n          if (sovietCountryIsoCodes.includes(datapoint.id)) {\n            return \"country soviet-country\";\n          } else {\n            return \"country non-soviet-country\";\n          }\n        });\n\n      resolve(countrySubunits);\n    });\n  });\n}\n","import loadMap from \"./loadMap\";\n\nexport default function update() {\n  window.onbeforeunload = function() {\n    window.scrollTo(0, 0);\n  };\n  const sovietCountryIsoCodes = [\n    \"ARM\",\n    \"AZE\",\n    \"BLR\",\n    \"EST\",\n    \"GEO\",\n    \"KAZ\",\n    \"KGZ\",\n    \"LVA\",\n    \"LTU\",\n    \"MDA\",\n    \"RUS\",\n    \"TJK\",\n    \"TKM\",\n    \"UKR\",\n    \"UZB\"\n  ];\n  var colors = [\n    \"#feedde\",\n    \"#fdbe85\",\n    \"#fd8d3c\",\n    \"#e6550d\",\n    \"#a63603\",\n    \"#feedde\",\n    \"#fdbe85\",\n    \"#fd8d3c\",\n    \"#e6550d\",\n    \"#feedde\",\n    \"#fdbe85\",\n    \"#fd8d3c\",\n    \"#e6550d\",\n    \"#a63603\"\n\t];\n\t\n\tlet countries = loadMap().then(countrySubunits => {\n\t\tconsole.warn({ countrySubunits });\n\t\treturn countries\n\t});\n  // initialize the scrollama\n  var scroller = scrollama();\n\n  // Setup sizes for the graphic and steps\n  var container = d3.select(\".scroll\");\n  var graphic = container.select(\".scroll__graphic\");\n  var text = container.select(\".scroll__text\");\n\n  var bodyWidth = d3.select(\"body\").node().offsetWidth;\n  var textWidth = text.node().offsetWidth;\n\n  var step = text.selectAll(\".step\");\n  var stepHeight = Math.floor(window.innerHeight * 0.75);\n\n  var graphicMargin = 16 * 4; // 64px\n  var graphicWidth = container.node().offsetWidth - graphicMargin;\n  const mapwidth = container.node().offsetWidth;\n  const graphicHeight = graphicWidth;\n  // var graphicHeight = Math.floor(window.innerHeight / 2.4);\n  console.warn({ graphicHeight });\n\n  var graphicMarginTop = Math.floor(window.innerHeight * 0.25);\n  // graphicMargin / 2;\n\n  step.style(\"height\", window.innerHeight + \"px\");\n\n  graphic\n    .style(\"width\", mapwidth + \"px\")\n    .style(\"height\", mapwidth + \"px\")\n    .style(\"top\", graphicMarginTop + \"px\");\n  // -----------------------------------\n  console.warn({ graphicHeight });\n  console.warn({ graphicWidth });\n  console.warn({ stepHeight });\n  console.warn(\"container.node().offsetHeight\", container.node().offsetHeight);\n  d3.select(\".header-container\").style(\"height\", 850 + \"px\");\n\n  d3.select(\".ussr-svg-container\").style(\"width\", graphicWidth + \"px\");\n  d3.select(\".intro-block\").style(\"width\", graphicWidth + \"px\");\n  d3.select(\".name-block\").style(\"width\", graphicWidth + \"px\");\n\n  d3.select(\".ussr-svg\").style(\"height\", 200 + \"px\");\n  d3.select(\".ussr-svg\").style(\"width\", 200 + \"px\");\n  // Animations\n\n  const mapContainer = d3.select(\".scroll__graphic\");\n  const boundingBox = mapContainer.node().getBoundingClientRect();\n  const { height, width } = boundingBox;\n\n  function firstAnimation() {\n    var scale = 2;\n\n    console.warn(\n      \"scroll container size\",\n      graphic.node().getBoundingClientRect()\n    );\n\n    var translateX = -Math.floor(graphicWidth * 0.75);\n    var translateY = -Math.floor(graphicHeight * 0.45);\n\n    console.warn({ scale });\n    console.warn({ width });\n    console.warn({ height });\n    console.warn({ translateX });\n    console.warn({ translateY });\n\n    d3.select(\"#map\")\n      .transition()\n      .duration(1000)\n      .attr(\n        \"transform\",\n        \"translate(\" +\n          width / 2 +\n          \",\" +\n          height / 2 +\n          \")scale(\" +\n          scale +\n          \")translate(\" +\n          translateX +\n          \",\" +\n          translateY +\n          \")\"\n      );\n\n    // d3.selectAll(\".soviet-country\")\n    //   .transition()\n    //   .duration(100)\n    //   .style(\"fill\", \"#a63603\")\n    //   .style(\"stroke-width\", 0.5 + \"px\");\n\n    d3.selectAll(\".non-soviet-country\")\n      .transition()\n      .duration(100)\n      .style(\"opacity\", \"0.5\")\n      .style(\"stroke-width\", 0.25 + \"px\");\n\n    d3.selectAll(\".soviet-country\")\n      .transition()\n      .duration(1000)\n      .style(\"fill\", function(d, i) {\n        // console.warn('i', i)\n        return colors[i];\n      });\n  }\n\n  function secondAnimation() {\n    var scale = 4;\n    var translateX = -Math.floor(graphicWidth * 0.7);\n    var translateY = -Math.floor(graphicHeight * 0.4);\n\n    d3.select(\"#map\")\n      .transition()\n      .duration(1000)\n      .attr(\n        \"transform\",\n        \"translate(\" +\n          width / 2 +\n          \",\" +\n          height / 2 +\n          \")scale(\" +\n          scale +\n          \")translate(\" +\n          translateX +\n          \",\" +\n          translateY +\n          \")\"\n      );\n\n    d3.selectAll(\".non-soviet-country\")\n      .transition()\n      .duration(500)\n      .style(\"stroke-width\", 0.175 + \"px\");\n\n    d3.selectAll(\".soviet-country\")\n      .transition()\n      .duration(500)\n      .style(\"stroke-width\", 0.25 + \"px\");\n\n    fourthAnimation();\n  }\n\n  function thirdAnimation() {}\n\n  var sovietLabelShift = {\n    ARM: { x: -12, y: 2 },\n    AZE: { x: -8, y: 5 },\n    BLR: { x: -14, y: 4 },\n    EST: { x: -12, y: 0 },\n    GEO: { x: -13, y: 1 },\n    KAZ: { x: 14, y: 6 },\n    KGZ: { x: 5, y: 3 },\n    LVA: { x: -12, y: 0 },\n    LTU: { x: -14, y: 0 },\n    MDA: { x: -12, y: 1 },\n    RUS: { x: -40, y: 10 },\n    TJK: { x: -4, y: 6 },\n    TKM: { x: -10, y: 8 },\n    UKR: { x: -9, y: 7 },\n    UZB: { x: -12, y: 0 }\n  };\n\n  function fourthAnimation() {\n\t\tconsole.warn({ countries });\n\n    d3.selectAll(\".non-soviet-country\")\n      .transition()\n      .duration(500)\n      .style(\"opacity\", \"0\");\n\n    d3.selectAll(\".place-label\")\n      .data(countries)\n      .enter()\n      .append(\"text\")\n      .attr(\"class\", \"place-label\")\n      .attr(\"transform\", function(d) {\n        // can get centroid easily like this!  path.centroid(d)\n        const [x, y] = path.centroid(d);\n        return `translate(${x},${y})`;\n      })\n      .attr(\"dx\", function({ id }) {\n        if (sovietCountryIsoCodes.includes(id)) {\n          const { x } = sovietLabelShift[id];\n          console.warn(x);\n          // can get centroid easily like this!  path.centroid(d)\n          return `${x}px`;\n        }\n        return;\n      })\n      .attr(\"dy\", function(d) {\n        if (sovietCountryIsoCodes.includes(d.id)) {\n          const name = d.id;\n          const { y } = sovietLabelShift[name];\n          // can get centroid easily like this!  path.centroid(d)\n          return `${y}px`;\n        }\n        return;\n      })\n      // .style(\"z-index\", '100')\n      .text(function(d) {\n        if (sovietCountryIsoCodes.includes(d.id)) {\n          console.warn(\"soviet datapoint\", d);\n          return d.properties.name;\n        }\n\n        return null;\n      })\n      .style(\"font-size\", 3 + \"px\");\n  }\n\n  // scrollama event handlers\n  // response = { element, direction, index }\n  function handleStepEnter(response) {\n    console.warn(\"handleStepEnter, response\", { response });\n\n    if (response.index === 0) {\n      console.warn(\"FIRST STEP!\");\n      firstAnimation();\n    }\n\n    if (response.index === 1) {\n      console.warn(\"SECOND STEP!\");\n      secondAnimation();\n    }\n\n    if (response.index === 2) {\n      console.warn(\"THIRD STEP!\");\n      thirdAnimation();\n    }\n\n    if (response.index === 3) {\n      console.warn(\"FOURTH STEP!\");\n      fourthAnimation();\n    }\n    // add color to current step only\n    step.classed(\"is-active\", function(d, i) {\n      return i === response.index;\n    });\n\n    // update graphic based on step\n    graphic.select(\"p\").text(response.index + 1);\n  }\n\n  function handleContainerEnter(response) {\n    d3.select(\".intro__overline\").classed(\"sticky_break\", true);\n    console.warn({ handleContainerEnter });\n    // response = { direction }\n  }\n\n  function handleContainerExit(response) {\n    console.warn({ handleContainerExit });\n    // response = { direction }\n  }\n\n  function setupStickyfill() {\n    d3.selectAll(\".sticky\").each(function() {\n      Stickyfill.add(this);\n    });\n  }\n\n  function init() {\n    setupStickyfill();\n    scroller\n      .setup({\n        container: \".scroll\",\n        graphic: \".scroll__graphic\",\n        text: \".scroll__text\",\n        step: \".scroll__text .step\",\n        debug: false,\n        offset: 0.9\n      })\n      .onStepEnter(handleStepEnter)\n      .onContainerEnter(handleContainerEnter)\n      .onContainerExit(handleContainerExit);\n\n    // setup resize event -> this is causing issues in mobile when the mobile headers resize\n    // window.addEventListener(\"resize\", handleResize);\n  }\n\n  // kick things off\n  init();\n\n\n\n}\n","import update from './update.js';\n\n// even though Rollup is bundling all your files together, errors and\n// logs will still point to your original source modules\nconsole.log('if you have sourcemaps enabled in your devtools, click on main.js:5 -->');\n\nupdate();"],"names":["sovietCountryIsoCodes","mercatorBounds","projection","maxlat","yaw","rotate","xymax","xymin","loadMap","Promise","resolve","reject","d3","json","console","warn","mapContainer","select","boundingBox","node","getBoundingClientRect","height","width","geo","mercator","scale","translate","b","s","scaleExtent","path","countrySubunits","topojson","feature","objects","subunits","features","svg","append","attr","map","selectAll","data","enter","style","d","i","id","datapoint","includes","update","window","onbeforeunload","scrollTo","colors","countries","then","scroller","scrollama","container","graphic","text","bodyWidth","offsetWidth","textWidth","step","stepHeight","Math","floor","innerHeight","graphicMargin","graphicWidth","mapwidth","graphicHeight","graphicMarginTop","offsetHeight","firstAnimation","translateX","translateY","transition","duration","secondAnimation","fourthAnimation","sovietLabelShift","ARM","x","y","AZE","BLR","EST","GEO","KAZ","KGZ","LVA","LTU","MDA","RUS","TJK","TKM","UKR","UZB","centroid","name","properties","handleStepEnter","response","index","thirdAnimation","classed","handleContainerEnter","handleContainerExit","setupStickyfill","each","Stickyfill","add","init","setup","debug","offset","onStepEnter","onContainerEnter","onContainerExit","log"],"mappings":"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"}