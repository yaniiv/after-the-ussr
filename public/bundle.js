!function(){"use strict";function t(t){const e=t.length,n=[];for(let o=0;o<e;o+=1)n.push(t[o]);return n}function e(t){return t instanceof Element?t:"string"==typeof t?document.querySelector(t):null}function n({id:t}){return`scrollama__debug-offset--${t}`}function o({id:t,offsetVal:e,stepEl:o}){!function({id:t,offsetVal:e,stepClass:o}){const i=document.createElement("div");i.setAttribute("id",n({id:t})),i.setAttribute("class","scrollama__debug-offset"),i.style.position="fixed",i.style.left="0",i.style.width="100%",i.style.height="0px",i.style.borderTop="2px dashed black",i.style.zIndex="9999";const r=document.createElement("p");r.innerText=`".${o}" trigger: ${e}`,r.style.fontSize="12px",r.style.fontFamily="monospace",r.style.color="black",r.style.margin="0",r.style.padding="6px",i.appendChild(r),document.body.appendChild(i)}({id:t,offsetVal:e,stepClass:o[0].getAttribute("class")})}function i({id:t,stepOffsetHeight:e,offsetMargin:o,offsetVal:i}){!function({id:t,offsetMargin:e,offsetVal:o}){const i=n({id:t});document.querySelector(`#${i}`).style.top=`${e}px`}({id:t,offsetMargin:o})}function r({id:t,index:e,state:n}){const o=function({id:t,i:e}){return`scrollama__debug-step--${t}-${e}`}({id:t,i:e}),i=document.querySelector(`#${o}_above`),r=document.querySelector(`#${o}_below`),s="enter"===n?"block":"none";i&&(i.style.display=s),r&&(r.style.display=s)}function s(){const n=1,s={},a={};let c=null,l=null,h=null,d=null,p=0,u=0,f=0,g=0,m=null,y=null,b=null,w=!1,x=!1,v=!1,_=!1,E=0,M=!1,I=!1,R=null,A=null,T=-1,O=null;const S=[];function k(t){let e=0;if(t.offsetParent)do{e+=t.offsetTop,t=t.offsetParent}while(t);return e<0?0:e}function C(t){return+t.getAttribute("data-scrollama-index")}function B(){window.pageYOffset>T?O="down":window.pageYOffset<T&&(O="up"),T=window.pageYOffset}function $(){f=window.innerHeight,g=function(){const t=document.body,e=document.documentElement;return Math.max(t.scrollHeight,t.offsetHeight,e.clientHeight,e.scrollHeight,e.offsetHeight)}(),b=l?l.getBoundingClientRect():null,u=p*f,m=h?h.map(t=>t.offsetHeight):[],y=h?h.map(k):[],x&&w&&Y(),v&&i({id:d,stepOffsetHeight:m,offsetMargin:u,offsetVal:p})}function L(t){t&&!x?(w&&Y(),x=!0):t||(a.top&&a.top.disconnect(),a.bottom&&a.bottom.disconnect(),a.stepAbove&&a.stepAbove.forEach(t=>t.disconnect()),a.stepBelow&&a.stepBelow.forEach(t=>t.disconnect()),a.stepProgress&&a.stepProgress.forEach(t=>t.disconnect()),a.viewportAbove&&a.viewportAbove.forEach(t=>t.disconnect()),a.viewportBelow&&a.viewportBelow.forEach(t=>t.disconnect()),x=!1)}function P(t,e){if("above"===e)for(let e=0;e<t;e++){const t=R[e];"enter"===t.state&&U(h[e],"down"),"up"===t.direction&&(H(h[e],"down",!1),U(h[e],"down"))}else if("below"===e)for(let e=R.length-1;e>t;e--){const t=R[e];"enter"===t.state&&U(h[e],"up"),"down"===t.direction&&(H(h[e],"up",!1),U(h[e],"up"))}}function H(t,e,n=!0){const o=C(t),i={element:t,index:o,direction:e};R[o].direction=e,R[o].state="enter",M&&n&&"down"===e&&P(o,"above"),M&&n&&"up"===e&&P(o,"below"),s.stepEnter&&"function"==typeof s.stepEnter&&!S[o]&&(s.stepEnter(i,R),v&&r({id:d,index:o,state:"enter"}),I&&(S[o]=!0)),_&&V(t,"down"===e?0:1)}function U(t,e){const n=C(t),o={element:t,index:n,direction:e};R[n].direction=e,R[n].state="exit",_&&V(t,"down"===e?1:0),s.stepExit&&"function"==typeof s.stepExit&&(s.stepExit(o,R),v&&r({id:d,index:n,state:"exit"}))}function V(t,e){const n={element:t,index:C(t),progress:e};s.stepProgress&&"function"==typeof s.stepProgress&&s.stepProgress(n)}function j(){const t={direction:O};A.direction=O,A.state="enter",s.containerEnter&&"function"==typeof s.containerEnter&&s.containerEnter(t)}function K(){const t={direction:O};A.direction=O,A.state="exit",s.containerExit&&"function"==typeof s.containerExit&&s.containerExit(t)}function D(t){B(),t.forEach(t=>{const{isIntersecting:e,boundingClientRect:o,target:i}=t,{bottom:r,height:s}=o,a=r-u,c=C(i),l=R[c];a>=-n&&(e&&"down"===O&&"enter"!==l.state?H(i,O):e||"up"!==O||"enter"!==l.state?!e&&a>=s&&"down"===O&&"enter"===l.state&&U(i,O):U(i,O))})}function F(t){B(),t.forEach(t=>{const{isIntersecting:e,boundingClientRect:o,target:i}=t,{bottom:r,height:s}=o,a=r-u,c=C(i),l=R[c];a>=-n&&a<s&&e&&"up"===O&&"enter"!==l.state?H(i,O):a<=n&&!e&&"down"===O&&"enter"===l.state&&U(i,O)})}function G(t){B(),t.forEach(t=>{const{isIntersecting:e,target:n}=t,o=C(n),i=R[o];e&&"down"===O&&"enter"!==i.state&&"down"!==i.direction&&(H(n,"down"),U(n,"down"))})}function Z(t){B(),t.forEach(t=>{const{isIntersecting:e,target:n}=t,o=C(n),i=R[o];e&&"up"===O&&"enter"!==i.state&&"up"!==i.direction&&(H(n,"up"),U(n,"up"))})}function q(t){B(),t.forEach(({isIntersecting:t,intersectionRatio:e,boundingClientRect:o,target:i})=>{const{bottom:r}=o;t&&r-u>=-n&&V(i,+e.toFixed(3))})}function N(t){B();const{isIntersecting:e,boundingClientRect:o}=t[0],{top:i,bottom:r}=o;r>-n&&(e?j():"enter"===A.state&&K())}function z(t){B();const{isIntersecting:e,boundingClientRect:o}=t[0],{top:i}=o;i<n&&(e?j():"enter"===A.state&&K())}function W(){a.stepProgress&&a.stepProgress.forEach(t=>t.disconnect()),a.stepProgress=h.map((t,e)=>{const n=`${m[e]-u}px 0px ${-f+u}px 0px`,o=function(t){const e=Math.ceil(t/E),n=[],o=1/e;for(let t=0;t<e;t++)n.push(t*o);return n}(m[e]),i=new IntersectionObserver(q,{root:null,rootMargin:n,threshold:o});return i.observe(t),i})}function Y(){a.viewportAbove&&a.viewportAbove.forEach(t=>t.disconnect()),a.viewportAbove=h.map((t,e)=>{const n=y[e],o=-(f-u+m[e]),i=new IntersectionObserver(G,{root:null,rootMargin:`${n}px 0px ${o}px 0px`,threshold:0});return i.observe(t),i}),a.viewportBelow&&a.viewportBelow.forEach(t=>t.disconnect()),a.viewportBelow=h.map((t,e)=>{const n=-(u+m[e]),o=g-y[e]-m[e]-u,i=new IntersectionObserver(Z,{root:null,rootMargin:`${n}px 0px ${o}px 0px`,threshold:0});return i.observe(t),i}),a.stepAbove&&a.stepAbove.forEach(t=>t.disconnect()),a.stepAbove=h.map((t,e)=>{const n=m[e],o=new IntersectionObserver(D,{root:null,rootMargin:`${n}px 0px ${-f+u}px 0px`,threshold:0});return o.observe(t),o}),a.stepBelow&&a.stepBelow.forEach(t=>t.disconnect()),a.stepBelow=h.map((t,e)=>{const n=-u,o=g-f+m[e]+u,i=new IntersectionObserver(F,{root:null,rootMargin:`${n}px 0px ${o}px 0px`,threshold:0});return i.observe(t),i}),_&&W(),c&&l&&(function(){a.top&&a.top.unobserve(c);const t={root:null,rootMargin:`${f}px 0px -${f}px 0px`,threshold:0};a.top=new IntersectionObserver(N,t),a.top.observe(c)}(),function(){a.bottom&&a.bottom.unobserve(c);const t={root:null,rootMargin:`-${b.height}px 0px ${b.height}px 0px`,threshold:0};a.bottom=new IntersectionObserver(z,t),a.bottom.observe(c)}())}const J={};return J.setup=(({container:n,graphic:i,step:r,offset:s=.5,progress:a=!1,threshold:u=4,debug:f=!1,order:g=!0,once:m=!1})=>(d=function(){const t="abcdefghijklmnopqrstuv",e=t.length,n=(new Date).getTime();return`${[0,0,0].map(n=>t[Math.floor(Math.random()*e)]).join("")}${n}`}(),h=function(e,n=document){return"string"==typeof e?t(n.querySelectorAll(e)):e instanceof Element?t([e]):e instanceof NodeList?t(e):e instanceof Array?e:[]}(r),c=n?e(n):null,l=i?e(i):null,h.length?(v=f,_=a,M=g,I=m,J.offsetTrigger(s),E=Math.max(1,+u),w=!0,v&&o({id:d,stepEl:h,offsetVal:p}),h.forEach((t,e)=>t.setAttribute("data-scrollama-index",e)),R=h.map(()=>({direction:null,state:null})),A={direction:null,state:null},$(),L(!0),J):(console.error("scrollama error: no step elements"),J))),J.resize=(()=>($(),J)),J.enable=(()=>(L(!0),J)),J.disable=(()=>(L(!1),J)),J.destroy=(()=>{L(!1),Object.keys(s).forEach(t=>s[t]=null),Object.keys(a).forEach(t=>a[t]=null)}),J.offsetTrigger=function(t){return t&&!isNaN(t)?(p=Math.min(Math.max(0,t),1),J):p},J.onStepEnter=(t=>(s.stepEnter=t,J)),J.onStepExit=(t=>(s.stepExit=t,J)),J.onStepProgress=(t=>(s.stepProgress=t,J)),J.onContainerEnter=(t=>(s.containerEnter=t,J)),J.onContainerExit=(t=>(s.containerExit=t,J)),J}!function(t,e){function n(t){this.time=t.time,this.target=t.target,this.rootBounds=t.rootBounds,this.boundingClientRect=t.boundingClientRect,this.intersectionRect=t.intersectionRect||{top:0,bottom:0,left:0,right:0,width:0,height:0},this.isIntersecting=!!t.intersectionRect;var e=this.boundingClientRect,n=e.width*e.height,o=this.intersectionRect,i=o.width*o.height;this.intersectionRatio=n?Number((i/n).toFixed(4)):this.isIntersecting?1:0}function o(t,e){var n,o,i,r=e||{};if("function"!=typeof t)throw new Error("callback must be a function");if(r.root&&1!=r.root.nodeType)throw new Error("root must be an Element");this._checkForIntersections=(n=this._checkForIntersections.bind(this),o=this.THROTTLE_TIMEOUT,i=null,function(){i||(i=setTimeout(function(){n(),i=null},o))}),this._callback=t,this._observationTargets=[],this._queuedEntries=[],this._rootMarginValues=this._parseRootMargin(r.rootMargin),this.thresholds=this._initThresholds(r.threshold),this.root=r.root||null,this.rootMargin=this._rootMarginValues.map(function(t){return t.value+t.unit}).join(" ")}function i(t,e,n,o){"function"==typeof t.addEventListener?t.addEventListener(e,n,o||!1):"function"==typeof t.attachEvent&&t.attachEvent("on"+e,n)}function r(t,e,n,o){"function"==typeof t.removeEventListener?t.removeEventListener(e,n,o||!1):"function"==typeof t.detatchEvent&&t.detatchEvent("on"+e,n)}function s(t){var e;try{e=t.getBoundingClientRect()}catch(t){}return e?(e.width&&e.height||(e={top:e.top,right:e.right,bottom:e.bottom,left:e.left,width:e.right-e.left,height:e.bottom-e.top}),e):{top:0,bottom:0,left:0,right:0,width:0,height:0}}function a(t,e){for(var n=e;n;){if(n==t)return!0;n=c(n)}return!1}function c(t){var e=t.parentNode;return e&&11==e.nodeType&&e.host?e.host:e}"IntersectionObserver"in t&&"IntersectionObserverEntry"in t&&"intersectionRatio"in t.IntersectionObserverEntry.prototype?"isIntersecting"in t.IntersectionObserverEntry.prototype||Object.defineProperty(t.IntersectionObserverEntry.prototype,"isIntersecting",{get:function(){return this.intersectionRatio>0}}):(o.prototype.THROTTLE_TIMEOUT=100,o.prototype.POLL_INTERVAL=null,o.prototype.USE_MUTATION_OBSERVER=!0,o.prototype.observe=function(t){if(!this._observationTargets.some(function(e){return e.element==t})){if(!t||1!=t.nodeType)throw new Error("target must be an Element");this._registerInstance(),this._observationTargets.push({element:t,entry:null}),this._monitorIntersections(),this._checkForIntersections()}},o.prototype.unobserve=function(t){this._observationTargets=this._observationTargets.filter(function(e){return e.element!=t}),this._observationTargets.length||(this._unmonitorIntersections(),this._unregisterInstance())},o.prototype.disconnect=function(){this._observationTargets=[],this._unmonitorIntersections(),this._unregisterInstance()},o.prototype.takeRecords=function(){var t=this._queuedEntries.slice();return this._queuedEntries=[],t},o.prototype._initThresholds=function(t){var e=t||[0];return Array.isArray(e)||(e=[e]),e.sort().filter(function(t,e,n){if("number"!=typeof t||isNaN(t)||t<0||t>1)throw new Error("threshold must be a number between 0 and 1 inclusively");return t!==n[e-1]})},o.prototype._parseRootMargin=function(t){var e=(t||"0px").split(/\s+/).map(function(t){var e=/^(-?\d*\.?\d+)(px|%)$/.exec(t);if(!e)throw new Error("rootMargin must be specified in pixels or percent");return{value:parseFloat(e[1]),unit:e[2]}});return e[1]=e[1]||e[0],e[2]=e[2]||e[0],e[3]=e[3]||e[1],e},o.prototype._monitorIntersections=function(){this._monitoringIntersections||(this._monitoringIntersections=!0,this.POLL_INTERVAL?this._monitoringInterval=setInterval(this._checkForIntersections,this.POLL_INTERVAL):(i(t,"resize",this._checkForIntersections,!0),i(e,"scroll",this._checkForIntersections,!0),this.USE_MUTATION_OBSERVER&&"MutationObserver"in t&&(this._domObserver=new MutationObserver(this._checkForIntersections),this._domObserver.observe(e,{attributes:!0,childList:!0,characterData:!0,subtree:!0}))))},o.prototype._unmonitorIntersections=function(){this._monitoringIntersections&&(this._monitoringIntersections=!1,clearInterval(this._monitoringInterval),this._monitoringInterval=null,r(t,"resize",this._checkForIntersections,!0),r(e,"scroll",this._checkForIntersections,!0),this._domObserver&&(this._domObserver.disconnect(),this._domObserver=null))},o.prototype._checkForIntersections=function(){var e=this._rootIsInDom(),o=e?this._getRootRect():{top:0,bottom:0,left:0,right:0,width:0,height:0};this._observationTargets.forEach(function(i){var r=i.element,a=s(r),c=this._rootContainsTarget(r),l=i.entry,h=e&&c&&this._computeTargetAndRootIntersection(r,o),d=i.entry=new n({time:t.performance&&performance.now&&performance.now(),target:r,boundingClientRect:a,rootBounds:o,intersectionRect:h});l?e&&c?this._hasCrossedThreshold(l,d)&&this._queuedEntries.push(d):l&&l.isIntersecting&&this._queuedEntries.push(d):this._queuedEntries.push(d)},this),this._queuedEntries.length&&this._callback(this.takeRecords(),this)},o.prototype._computeTargetAndRootIntersection=function(n,o){if("none"!=t.getComputedStyle(n).display){for(var i,r,a,l,h,d,p,u,f=s(n),g=c(n),m=!1;!m;){var y=null,b=1==g.nodeType?t.getComputedStyle(g):{};if("none"==b.display)return;if(g==this.root||g==e?(m=!0,y=o):g!=e.body&&g!=e.documentElement&&"visible"!=b.overflow&&(y=s(g)),y&&(i=y,r=f,a=void 0,l=void 0,h=void 0,d=void 0,p=void 0,u=void 0,a=Math.max(i.top,r.top),l=Math.min(i.bottom,r.bottom),h=Math.max(i.left,r.left),d=Math.min(i.right,r.right),u=l-a,!(f=(p=d-h)>=0&&u>=0&&{top:a,bottom:l,left:h,right:d,width:p,height:u})))break;g=c(g)}return f}},o.prototype._getRootRect=function(){var t;if(this.root)t=s(this.root);else{var n=e.documentElement,o=e.body;t={top:0,left:0,right:n.clientWidth||o.clientWidth,width:n.clientWidth||o.clientWidth,bottom:n.clientHeight||o.clientHeight,height:n.clientHeight||o.clientHeight}}return this._expandRectByRootMargin(t)},o.prototype._expandRectByRootMargin=function(t){var e=this._rootMarginValues.map(function(e,n){return"px"==e.unit?e.value:e.value*(n%2?t.width:t.height)/100}),n={top:t.top-e[0],right:t.right+e[1],bottom:t.bottom+e[2],left:t.left-e[3]};return n.width=n.right-n.left,n.height=n.bottom-n.top,n},o.prototype._hasCrossedThreshold=function(t,e){var n=t&&t.isIntersecting?t.intersectionRatio||0:-1,o=e.isIntersecting?e.intersectionRatio||0:-1;if(n!==o)for(var i=0;i<this.thresholds.length;i++){var r=this.thresholds[i];if(r==n||r==o||r<n!=r<o)return!0}},o.prototype._rootIsInDom=function(){return!this.root||a(e,this.root)},o.prototype._rootContainsTarget=function(t){return a(this.root||e,t)},o.prototype._registerInstance=function(){},o.prototype._unregisterInstance=function(){},t.IntersectionObserver=o,t.IntersectionObserverEntry=n)}(window,document);var a={0:function(t){t.animateSectionStyles({duration:1e3,section:".non-soviet-country",styles:{opacity:"0.5","stroke-width":"0.25px"}})},1:function(t){const e={scale:4,duration:1e3,translateX:-Math.floor(.462*t.width),translateY:-Math.floor(.2*t.height)};t.animateMapZoom(e),t.createLabels(),t.createPopulationChoropleth(),t.animateSectionStyles({duration:500,section:".non-soviet-country",styles:{opacity:"0","stroke-width":"0.175px"}})},2:function(t,e){t.moveMapContainer({duration:1e3,top:Math.floor(.05*window.innerHeight)}),e.fadeTextIn()},3:function(t,e){e.animateBarsIn(),e.addPopulationLabels(),t.addPointsToMap()},4:function(t){t.drawCurves(),t.drawArrows()},5:function(t,e){},6:()=>{}};const c=["ARM","AZE","BLR","EST","GEO","KAZ","KGZ","LVA","LTU","MDA","RUS","TJK","TKM","UKR","UZB"],l=["#feedde","#fdbe85","#fd8d3c","#e6550d","#dd6344","#feedde","#fdbe85","#fd8d3c","#e6550d","#feedde","#fdbe85","#fd8d3c","#e6550d","#dd6344"],h={ARM:{x:-16,y:3},AZE:{x:-14,y:7},BLR:{x:-20,y:2},EST:{x:-13,y:-3},GEO:{x:-18,y:1},KAZ:{x:13,y:15},KGZ:{x:1,y:10},LVA:{x:-15,y:-2},LTU:{x:-18,y:0},MDA:{x:-18,y:2},RUS:{x:-40,y:10},TJK:{x:-6,y:10},TKM:{x:-20,y:10},UKR:{x:-23,y:0},UZB:{x:-12,y:18}},d=-20,p=83;class u{constructor(t){this.data=t.data,this.sovietDataPoints=t.data.filter(t=>c.includes(t.id)),this.element=t.element,this.draw()}getMercatorBounds(t){const e=t.rotate()[0],n=t([180-e-1e-6,-p]);return[t([-e-180+1e-6,p]),n]}draw(){const t=d3.select(this.element).node().getBoundingClientRect();this.height=t.height,this.width=t.width,this.projection=d3.geo.mercator().rotate([d,0]).scale(1).translate([this.width/2,this.height/2]);const e=this.getMercatorBounds(this.projection),n=this.width/(e[1][0]-e[0][0]),o=[n,10*n];this.projection.scale(o[0]),this.path=d3.geo.path().projection(this.projection);const i=d3.select(this.element).append("svg").attr("width",this.width).attr("height",this.height);this.mapGraphic=i.append("g").attr("id","map"),this.mapGraphic.selectAll("path").data(this.data).enter().append("path").attr("d",this.path).style("stroke-width","0.5px").attr("class","country").attr("id",function(t,e){return"country"+t.id}).attr("class",function(t,e){return c.includes(t.id)?"country soviet-country":"country non-soviet-country"})}animateSectionStyles({duration:t,section:e,styles:n}){console.warn({duration:t,section:e,styles:n}),d3.select(this.element).selectAll(e).transition().duration(t).style(n)}animateMapZoom({scale:t,translateX:e,translateY:n,duration:o}){this.mapGraphic.transition().duration(o).attr("transform",`scale(${t})translate(${e},${n})`)}createLabels(){this.sovietDataPoints.map(t=>this.path.centroid(t));this.mapGraphic.selectAll(".place-label").data(this.sovietDataPoints).enter().append("text").attr("class","place-label").attr("transform",t=>{const[e,n]=this.path.centroid(t);return`translate(${e},${n})`}).attr("dx",function({id:t}){const{x:e}=h[t];return`${e}px`}).attr("dy",function({id:t}){const{y:e}=h[t];return`${e}px`}).text(function(t){return t.properties.name}).style("font-size","3px")}createPopulationChoropleth(){d3.selectAll(".soviet-country").transition().duration(1e3).style("fill",function(t,e){return l[e]}).style("stroke-width","0.25px")}moveMapContainer({top:t,duration:e}){d3.select(this.element).transition().duration(e).style("top",t+"px")}addPointsToMap(){const t=this.sovietDataPoints.map(t=>this.path.centroid(t));this.mapGraphic.selectAll(".centroid").data(t).enter().append("circle").attr("fill","black").attr("r","0.45px").attr("cx",function(t){return t[0]}).attr("cy",function(t){return t[1]});this.mapGraphic.selectAll(".russia-centroid").data([235,110]).enter().append("circle").attr("fill","white").attr("r","0.25px").attr("cx",function(t){return t[0]}).attr("cy",function(t){return t[1]})}drawArrows(){const t=this.sovietDataPoints.filter(({id:t})=>"RUS"!==t).map(t=>this.path.centroid(t));console.warn("ayyeee drawing an arrow"),this.mapGraphic.selectAll(".centroid").data(t).enter().append("line").attr("x1",function(t){return t[0]}).attr("y1",function(t){return t[1]}).attr("x2",function(t){return t[0]+5}).attr("y2",function(t){return t[1]+10}).attr("stroke","black").attr("stroke-width",.1).attr("marker-end","url(#arrow)")}drawCurves(){const t=this.sovietDataPoints.filter(({id:t})=>"RUS"!==t).map(t=>this.path.centroid(t)).map((t,e)=>({trade:e,...t}));console.warn("centroidsWithValues",t);const e=[235,110];this.mapGraphic.append("g").selectAll("path.datamaps-arc").data(t).enter().append("path").attr("class","arc").attr("d",(t,n)=>{console.warn({datum:t});const o=[t[0],t[1]],i=[(o[0]+e[0])/2,(o[1]+e[1])/2],r=[i[0],i[1]-15];return"M"+o[0]+","+o[1]+"S"+r[0]+","+r[1]+","+e[0]+","+e[1]}).style("fill","none").style("stroke-width","0.5px").style("stroke",(t,e)=>l[e]).style("opacity","0").transition().duration(1e3).style("opacity","1")}animateNetMigration(){}}const f=[{name:"ARM",population:3.5},{name:"AZE",population:7.271},{name:"BLR",population:10.19},{name:"EST",population:1.568},{name:"GEO",population:6.653},{name:"KAZ",population:16.45},{name:"KGZ",population:4.464},{name:"LVA",population:2.658},{name:"LTU",population:3.7},{name:"MDA",population:3.7},{name:"TJK",population:5.4},{name:"TKM",population:3.772},{name:"UKR",population:52},{name:"UZB",population:20.95}].sort(function(t,e){return d3.ascending(t.population,e.population)});class g{constructor(t){this.data=t.data,this.sovietDataPoints=t.data.filter(t=>c.includes(t.id)),this.element=t.element,this.draw()}draw(){const t=d3.select(".scroll__graphic").node().getBoundingClientRect(),{height:e,width:n}=t;this.barMargin={top:15,right:75,bottom:0,left:60};const o=d3.select(".scroll").select(".scroll__text").node().offsetWidth;this.width=o-this.barMargin.left-this.barMargin.right,this.height=e-100-this.barMargin.top-this.barMargin.bottom,this.plot=d3.select("#bar-graphic").append("svg").attr("width",this.width+this.barMargin.left+this.barMargin.right).attr("height",this.height+this.barMargin.top+this.barMargin.bottom).append("g").attr("transform","translate("+this.barMargin.left+","+this.barMargin.top+")").style("opacity","0"),this.createScales(),this.addYAxes()}createScales(){this.xScale=d3.scale.linear().range([0,this.width]).domain([0,d3.max(f,function(t){return t.population})]),this.yScale=d3.scale.ordinal().rangeRoundBands([this.height,0],.1).domain(f.map(function(t){return t.name}))}addYAxes(){const t=d3.svg.axis().scale(this.yScale).tickSize(0).orient("left");this.plot.append("g").attr("class","y-axis").call(t),this.bars=this.plot.selectAll(".bar").data(f).enter().append("g"),this.bars.append("rect").attr("class","bar").attr("y",t=>this.yScale(t.name)).attr("height",()=>this.yScale.rangeBand()).attr("x",0).attr("width",0)}addPopulationLabels(){const t=d3.select("#bar-graphic").select("svg");t.select("g").selectAll(".text").data(f).enter().append("text").attr("class","label").attr("y",t=>this.yScale(t.name)).attr("x",t=>this.xScale(t.population)+1).attr("dx",".75em").text(function(t){return t.population}).attr("transform","translate(0,"+this.barMargin.top+")").style("opacity","0"),t.selectAll(".label").transition().delay(1500).duration(1e3).style("opacity","1")}fadeTextIn(){this.plot.transition().delay(1e3).duration(500).style("opacity","1"),d3.select(".bar-graphic-header").transition().delay(1e3).duration(500).style("opacity","1").style("color","black")}animateBarsIn(){d3.selectAll("rect").transition().delay(function(t,e){return 100*e}).attr("fill",function(t,e){return l[e]}).attr("width",t=>this.xScale(t.population))}}console.log("if you have sourcemaps enabled in your devtools, click on main.js:5 --\x3e"),window.onbeforeunload=function(){window.scrollTo(0,0)},new Promise((t,e)=>{d3.json("https://yantonsoup.github.io/after-the-ussr/public/json/110topoworld.json",function(e){console.warn("loaded 110topoworld.json:",e),t(e)})}).then(t=>{!function(){var t=d3.select(".scroll");const e=t.node().getBoundingClientRect(),{width:n,height:o}=e,i=t.select(".scroll__text"),r=i.node().offsetWidth,s=i.selectAll(".step"),a=Math.floor(1*window.innerHeight);s.style("height",a+"px"),i.selectAll(".step-two").style("height","200px");const c=Math.floor(.5*window.innerHeight);d3.select(".data__graphic").style("top",c+"px");const l=Math.floor(.25*window.innerHeight);d3.select(".scroll__graphic").style("width",n+"px").style("height",n+"px").style("top",l+"px"),d3.select(".header-container").style("height","900px"),d3.select(".ussr-svg-container").style("width",r+"px"),d3.select(".intro-block").style("width",r+"px"),d3.select(".name-block").style("width",r+"px"),d3.select(".ussr-svg").style("height","200px"),d3.select(".ussr-svg").style("width","200px")}();const e=topojson.feature(t,t.objects.subunits).features,n=new u({data:e,element:".scroll__graphic"}),o=new g({element:"#bar-graphic",data:e});console.warn("features",e),function(t,e){s().setup({container:".scroll",graphic:".scroll__graphic",text:".scroll__text",step:".scroll__text .step",debug:!1,offset:.9}).onStepEnter(function(n){console.warn("SCROLLAMA animation[index]:: ",n.index);const o=n.index;(0,a[o])(t,e)}).onContainerEnter(function(t){console.warn("Scrollama :: handleContainerEnter")}).onContainerExit(function(t){console.warn("Scrollama :: handleContainerExit")})}(n,o)})}();
//# sourceMappingURL=bundle.js.map
