<!DOCTYPE html>
<!-- saved from url=(0056)https://russellgoldenberg.github.io/scrollama/sticky-js/ -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>Scrollama Demo: Sticky JS</title>
	<meta name="description" content="Scrollama Demo: Sticky JS">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO"
		crossorigin="anonymous">
		<link rel="stylesheet" href="./index.css">

</head>

<body>
		<!-- <nav class="navbar navbar-expand-lg navbar-light bg-light">hi</nav> -->

	<section id="intro">
		<p class="intro__overline">
			<a href="https://github.com/russellgoldenberg/scrollama">LetterBox</a>
		</p>
		<h1 class="intro__hed">Soviet Immigration</h1>
		<p class="intro__dek">
			Start scrolling to see how it works.
		</p>
		<p class="intro__paragraph">
			Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in 
		</p>
	</section>
	<section id="scroll">
		<div class="scroll__graphic sticky" style="width: 794px; height: 709px; top: 254px;">
			<p>0</p>
		</div>
		<div class="scroll__text">
			<div class="step" data-step="1" data-scrollama-index="0" style="height: 1063px;">
				<p>STEP 1</p>
			</div>
			<div class="step" data-step="2" data-scrollama-index="1" style="height: 1063px;">
				<p>STEP 2</p>
			</div>
			<div class="step" data-step="3" data-scrollama-index="2" style="height: 1063px;">
				<p>STEP 3</p>
			</div>
			<div class="step" data-step="4" data-scrollama-index="3" style="height: 1063px;">
				<p>STEP 4</p>
			</div>
		</div>
	</section>
	<section id="outro"></section>
	<div class="debug"></div>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/5.7.0/d3.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/stickyfill/2.1.0/stickyfill.min.js"></script>
	<script src='https://unpkg.com/intersection-observer@0.5.0/intersection-observer.js'></script>
	<script src='https://unpkg.com/scrollama'></script>
	<script>
		window.onbeforeunload = function () {
  		window.scrollTo(0, 0);
		}
		// using d3 for convenience
		var container = d3.select('#scroll');
		var graphic = container.select('.scroll__graphic');
		var text = container.select('.scroll__text');
		var step = text.selectAll('.step');

		// initialize the scrollama
		var scroller = scrollama();

		// generic window resize listener event
		function handleResize() {
			// 1. update height of step elements
			var stepHeight = Math.floor(window.innerHeight * 0.75);
			step.style('height', stepHeight + 'px');

			// 2. update width/height of graphic element
			var bodyWidth = d3.select('body').node().offsetWidth;

			var graphicMargin = 16 * 4;
			var textWidth = text.node().offsetWidth;
			var graphicWidth = container.node().offsetWidth - graphicMargin;
			var graphicHeight = Math.floor(window.innerHeight / 2.4)
			var graphicMarginTop = Math.floor(window.innerHeight / 6)

			graphic
				.style('width', graphicWidth + 'px')
				.style('height', graphicHeight + 'px')
				.style('top', graphicMarginTop + 'px');


			// 3. tell scrollama to update new element dimensions
			scroller.resize();
		}

		// scrollama event handlers
		function handleStepEnter(response) {
			console.warn('handleStepEnter', {response})
			console.warn('handleStepEnter step index: response.index', response.index)

			// response = { element, direction, index }

			// add color to current step only
			step.classed('is-active', function (d, i) {
				return i === response.index;
			})

			// update graphic based on step
			graphic.select('p').text(response.index + 1);
		}

		function handleContainerEnter(response) {
			d3.select('.intro__overline').classed('sticky_break', true)
			console.warn({handleContainerEnter})
			// response = { direction }
		}

		function handleContainerExit(response) {
			console.warn({handleContainerExit})

			// response = { direction }
		}

		function setupStickyfill() {
			d3.selectAll('.sticky').each(function () {
				Stickyfill.add(this);
			});
		}

		function init() {
			setupStickyfill();

			// 1. force a resize on load to ensure proper dimensions are sent to scrollama
			handleResize();

			// 2. setup the scroller passing options
			// this will also initialize trigger observations
			// 3. bind scrollama event handlers (this can be chained like below)
			scroller.setup({
				container: '#scroll',
				graphic: '.scroll__graphic',
				text: '.scroll__text',
				step: '.scroll__text .step',
				debug: true,
				offset: 0.5,
			})
				.onStepEnter(handleStepEnter)
				.onContainerEnter(handleContainerEnter)
				.onContainerExit(handleContainerExit);

			// setup resize event
			window.addEventListener('resize', handleResize);
		}

		// kick things off
		init();
	// </script>


</body></html>